/*!
  hey, [be]Lazy.js - v1.3.1 - 2015.02.01 
  A lazy loading and multi-serving image script
  (c) Bjoern Klinggaard - @bklinggaard - http://dinbror.dk/blazy
*/
!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.Blazy=t()}(this,function(){"use strict";function e(e){if(!document.querySelectorAll){var o=document.createStyleSheet();document.querySelectorAll=function(e,t,r,n,s){for(s=document.all,t=[],e=e.replace(/\[for\b/gi,"[htmlFor").split(","),r=e.length;r--;){for(o.addRule(e[r],"k:v"),n=s.length;n--;)s[n].currentStyle.k&&t.push(s[n]);o.removeRule(0)}return t}}g=!0,v=[],p={},m=e||{},m.error=m.error||!1,m.offset=m.offset||100,m.success=m.success||!1,m.selector=m.selector||".b-lazy",m.separator=m.separator||"|",m.container=m.container?document.querySelectorAll(m.container):!1,m.errorClass=m.errorClass||"b-error",m.breakpoints=m.breakpoints||!1,m.successClass=m.successClass||"b-loaded",m.src=d=m.src||"data-src",w=window.devicePixelRatio>1,p.top=0-m.offset,p.left=0-m.offset,y=f(r,25),b=f(i,50),i(),u(m.breakpoints,function(e){var t=e.mode||"screen",r="viewport"==t?document.documentElement.clientWidth:window.screen.width;return e.width>=r?(d=e.src,!1):void 0}),t()}function t(){c(m.selector),g&&(g=!1,m.container&&u(m.container,function(e){a(e,"scroll",y)}),a(window,"resize",b),a(window,"resize",y),a(window,"scroll",y)),r()}function r(){for(var t=0;h>t;t++){var r=v[t];(n(r)||s(r))&&(e.prototype.load(r),v.splice(t,1),h--,t--)}0===h&&e.prototype.destroy()}function o(e,t){if(t||e.offsetWidth>0&&e.offsetHeight>0){var r=e.getAttribute(d)||e.getAttribute(m.src);if(r){var o=r.split(m.separator),n=o[w&&o.length>1?1:0],s=new Image;u(m.breakpoints,function(t){e.removeAttribute(t.src)}),e.removeAttribute(m.src),s.onerror=function(){m.error&&m.error(e,"invalid"),e.className=e.className+" "+m.errorClass},s.onload=function(){"img"===e.nodeName.toLowerCase()?e.src=n:e.style.backgroundImage='url("'+n+'")',e.className=e.className+" "+m.successClass,m.success&&m.success(e)},s.src=n}else m.error&&m.error(e,"missing"),e.className=e.className+" "+m.errorClass}}function n(e){var t=e.getBoundingClientRect();return t.right>=p.left&&t.bottom>=p.top&&t.left<=p.right&&t.top<=p.bottom}function s(e){return-1!==(" "+e.className+" ").indexOf(" "+m.successClass+" ")}function c(e){var t=document.querySelectorAll(e);h=t.length;for(var r=h;r--;v.unshift(t[r]));}function i(){p.bottom=(window.innerHeight||document.documentElement.clientHeight)+m.offset,p.right=(window.innerWidth||document.documentElement.clientWidth)+m.offset}function a(e,t,r){e.attachEvent?e.attachEvent&&e.attachEvent("on"+t,r):e.addEventListener(t,r,!1)}function l(e,t,r){e.detachEvent?e.detachEvent&&e.detachEvent("on"+t,r):e.removeEventListener(t,r,!1)}function u(e,t){if(e&&t)for(var r=e.length,o=0;r>o&&t(e[o],o)!==!1;o++);}function f(e,t){var r=0;return function(){var o=+new Date;t>o-r||(r=o,e.apply(v,arguments))}}var d,m,p,v,h,w,g,y,b;return e.prototype.revalidate=function(){t()},e.prototype.load=function(e,t){s(e)||o(e,t)},e.prototype.destroy=function(){m.container&&u(m.container,function(e){l(e,"scroll",y)}),l(window,"scroll",y),l(window,"resize",y),l(window,"resize",b),h=0,v.length=0,g=!0},e});