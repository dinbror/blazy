/*!
  hey, [be]Lazy.js - v1.2.2 - 2014.05.04
  A lazy loading and multi-serving image script
  (c) Bjoern Klinggaard - @bklinggaard - http://dinbror.dk/blazy
*/
(function(e){if(typeof define==="function"&&define.amd){define(e)}else{window.Blazy=e()}})(function(){"use strict";function l(n){if(!document.querySelectorAll){var r=document.createStyleSheet();document.querySelectorAll=function(e,t,n,i,s){s=document.all,t=[],e=e.replace(/\[for\b/gi,"[htmlFor").split(",");for(n=e.length;n--;){r.addRule(e[n],"k:v");for(i=s.length;i--;)s[i].currentStyle.k&&t.push(s[i]);r.removeRule(0)}return t}}u=true;i=[];t=n||{};t.error=t.error||false;t.offset=t.offset||100;t.success=t.success||false;t.selector=t.selector||".b-lazy";t.separator=t.separator||"|";t.container=t.container?document.querySelectorAll(t.container):false;t.errorClass=t.errorClass||"b-error";t.breakpoints=t.breakpoints||false;t.loadingbar=t.loadingbar||false;t.successClass=t.successClass||"b-loaded";t.src=e=t.src||"data-src";o=window.devicePixelRatio>1;a=E(h,25);f=E(g,50);g();w(t.breakpoints,function(t){if(t.width>=window.screen.width){e=t.src;return false}});c()}function c(){m(t.selector);if(u){u=false;if(t.container){w(t.container,function(e){y(e,"scroll",a)})}y(window,"resize",f);y(window,"resize",a);y(window,"scroll",a)}h()}function h(){for(var e=0;e<s;e++){var t=i[e];if(d(t)||v(t)){l.prototype.load(t);i.splice(e,1);s--;e--}}if(s===0){l.prototype.destroy()}}function p(n){if(n.offsetWidth>0&&n.offsetHeight>0){var r=n.getAttribute(e)||n.getAttribute(t.src);if(r){var i=r.split(t.separator);var s=i[o&&i.length>1?1:0];var u=n.parentNode;var a=document.createElement("div");var f=new Image;f.src=s;w(t.breakpoints,function(e){n.removeAttribute(e.src)});n.removeAttribute(t.src);var l=new XMLHttpRequest;l.onloadstart=function(){if(t.loadingbar){a.className="loading-bar";a.style.width="1%";u.appendChild(a)}};l.onerror=function(){if(t.error)t.error(n,"invalid");n.className=n.className+" "+t.errorClass};l.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;a.style.width=t+"%"}};l.onloadend=function(){n.nodeName.toLowerCase()==="img"?n.src=s:n.style.backgroundImage='url("'+s+'")';n.className=n.className+" "+t.successClass;if(t.success)t.success(n);if(t.loadingbar)u.removeChild(a)};l.open("GET",s,true);l.send()}else{if(t.error)t.error(n,"missing");n.className=n.className+" "+t.errorClass}}}function d(e){var i=e.getBoundingClientRect();var s=r+t.offset;return i.left>=0&&i.right<=n+t.offset&&(i.top>=0&&i.top<=s||i.bottom<=s&&i.bottom>=0-t.offset)}function v(e){return(" "+e.className+" ").indexOf(" "+t.successClass+" ")!==-1}function m(e){var t=document.querySelectorAll(e);s=t.length;for(var n=s;n--;i.unshift(t[n])){}}function g(){r=window.innerHeight||document.documentElement.clientHeight;n=window.innerWidth||document.documentElement.clientWidth}function y(e,t,n){if(e.attachEvent){e.attachEvent&&e.attachEvent("on"+t,n)}else{e.addEventListener(t,n,false)}}function b(e,t,n){if(e.detachEvent){e.detachEvent&&e.detachEvent("on"+t,n)}else{e.removeEventListener(t,n,false)}}function w(e,t){if(e&&t){var n=e.length;for(var r=0;r<n&&t(e[r],r)!==false;r++){}}}function E(e,t){var n=0;return function(){var r=+(new Date);if(r-n<t){return}n=r;e.apply(i,arguments)}}var e,t,n,r,i,s,o,u;var a,f;l.prototype.revalidate=function(){c()};l.prototype.load=function(e){if(!v(e))p(e)};l.prototype.destroy=function(){if(t.container){w(t.container,function(e){b(e,"scroll",a)})}b(window,"scroll",a);b(window,"resize",a);b(window,"resize",f);s=0;i.length=0;u=true};return l})